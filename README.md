# 기록용

## 메인 질문

> 이런 아키텍처를 생각할 때, 어떤 관점으로 접근해야 할까?

---

## 기본 개념: CRUD

* **Create**
* **Read**
* **Update**
* **Delete**

모든 도메인 객체는 기본적으로 CRUD를 가진다.

---

## 접근 방법

### 1. 기능부터 생각하기

* 디스코드의 핵심 기능은?

    * 채널 생성
    * 유저 초대
    * 메시지 송수신
* DM, 기타 기능은 일단 제외
* **가장 핵심적인 기능부터 구현 후 확장**

---

## 도메인 추상화

### 핵심 엔티티

* **User**
* **Message**
* **Channel**

> 가정
>
> * 유저가 존재한다
> * 유저는 채널 내에서 메시지를 주고받는다

---

## 엔티티 간 관계 정리

### User

* 유저 자체 정보 보유
* 메시지, 채널에서 참조되는 대상

### Message

* 보내는 유저 정보
* 메시지 내용
* 채널 정보
* 생성 / 수정 시간

### Channel

* 채널에 속한 유저 목록
* 채널에 속한 메시지 목록
* 채널 이름

고민 포인트

* 메시지와 채널 클래스를 완전히 분리할 수 있을까?
* 객체 필드 기준으로 설계할지, **메서드 시그니처(입력/출력)** 기준으로 설계할지?

---

## 공통 필드 (모든 객체 공통)

* `id`
* `createdAt`
* `updatedAt`

---

## User 설계

### 필드

* id (UIDD)
* createdAt
* updatedAt

### CRUD

#### 유저 생성 (Create)

* 입력: 초기값
* 출력: `boolean` (성공 / 실패 이유)

#### 유저 조회 (Read)

* 입력: 없음
* 출력:

    * id
    * createdAt
    * updatedAt
    * 유저가 속한 채널 목록
    * 유저가 작성한 메시지 목록

#### 유저 수정 (Update)

* 입력: 변경할 id
* 출력: 성공 여부

#### 유저 삭제 (Delete)

* 입력: 삭제할 id
* 출력: 성공 여부

---

## Message 설계

### 필드

* id (UIDD)
* createdAt
* updatedAt
* content

### CRUD

#### 메시지 생성 (Create)

* 입력:

    * 유저 정보
    * 메시지 내용
    * 채널 정보
* 검증:

    * 유저 존재 여부
    * 채널 존재 여부
    * 메시지 길이 제한
* 출력: 성공 여부

#### 메시지 조회 (Read)

* 입력: 없음
* 출력:

    * 유저 정보
    * 메시지 내용
    * 생성 시간
    * 수정 시간
    * 채널 정보

#### 메시지 수정 (Update)

* 입력:

    * 기존 메시지 정보
    * 수정할 내용
* 출력: 성공 여부

#### 메시지 삭제 (Delete)

* 입력: 삭제할 메시지 정보
* 출력: 성공 여부

---

## Channel 설계

### 필드

* id (UIDD)
* createdAt
* updatedAt
* channelName

### CRUD

#### 채널 생성 (Create)

* 입력:

    * 채널명
    * 초대할 유저 id
* 출력: 성공 여부

#### 채널 조회 (Read)

* 출력:

    * 채널명
    * 생성 시간
    * 수정 시간
    * 채널 내 메시지 목록
    * 채널 내 유저 목록

#### 채널 수정 (Update)

* 입력: 채널 정보 수정
* 출력: 성공 여부

#### 채널 삭제 (Delete)

* 출력: 성공 여부

---

## 현재 느낀 문제점

* User / Message / Channel 사이에

    * **겹치는 필드**
    * **겹치는 메서드**
      가 많아 보인다
* 공통 로직을 어떻게 분리할지 고민 필요

    * BaseEntity?
    * 공통 인터페이스?
    * Service 레이어 분리?
